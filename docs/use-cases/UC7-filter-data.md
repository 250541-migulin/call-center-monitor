# UC7: Отфильтровать данные по параметрам

## Актёр
Руководитель

## Описание
Руководитель применяет фильтры к журналу звонков и обращений, чтобы сузить выборку данных по заданным критериям.  
Фильтрация применяется ко всем типам данных: звонкам, обращениям, статистике.

## Предусловия
- В системе имеются зафиксированные звонки и обращения.
- Руководитель находится на странице с таблицей данных (например, «Все звонки» или «История обращений»).

## Основной поток событий (Flow of Events)
1. Руководитель открывает панель фильтрации (расположена над таблицей).
2. Система отображает следующие элементы управления:
   - **Дата**: два поля с календарём («От» и «До»),
   - **Оператор**: мультиселект с выпадающим списком всех операторов,
   - **Клиент**: текстовое поле для ввода имени или номера телефона,
   - **Ресурс**: чекбоксы (`portal.example.com`, `api.example.com`, `mobile-app`),
   - **Статус обращения**: радиокнопки (`Решено`, `Не решено`, `Любой`).
3. Руководитель выбирает один или несколько параметров.
4. Руководитель нажимает кнопку **«Применить фильтр»**.
5. Система отправляет запрос в сервис фильтрации (`FilterService`).
6. Система получает отфильтрованные данные из базы.
7. Система обновляет таблицу, отображая только соответствующие записи.
8. Система сохраняет параметры фильтрации в URL (например, `?dateFrom=2026-01-01&status=solved`).

## Альтернативные потоки

### A1: Нет данных по фильтру
1. На шаге 6 система получает пустой результат.
2. Система отображает: **«Нет записей, соответствующих выбранным фильтрам»** вместо таблицы.

### A2: Некорректный диапазон дат
1. Руководитель указывает дату «От» > даты «До».
2. При нажатии «Применить» система проверяет диапазон.
3. Система показывает: **«Дата начала не может быть позже даты окончания»** и блокирует применение.

### A3: Сброс фильтров
1. Руководитель нажимает кнопку **«Сбросить»** (рядом с «Применить»).
2. Система очищает все поля фильтрации и возвращает таблицу к исходному состоянию (все записи).

### A4: Ошибка загрузки данных
1. На шаге 6 возникает ошибка БД или таймаут.
2. Система отображает: **«Не удалось применить фильтр. Повторите попытку»** с кнопкой **«Повторить»**.

## Постусловия
- Руководитель получает узкую выборку данных, соответствующую его запросу.
- Выборка может быть:
  - проанализирована вручную,
  - экспортирована (UC8),
  - использована для формирования отчётов.

## Примечание
- Все фильтры должны быть видны в `manager-view.png`.
- Сохранение параметров в URL позволяет делиться ссылками с коллегами.
- Фильтрация работает **только по данным в рабочее время**, если не указано иное.