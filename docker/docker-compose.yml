services:
  asterisk:
    image: andrius/asterisk:latest
    container_name: asterisk
    ports:
      - "5060:5060/tcp"
      - "5060:5060/udp"
      - "5038:5038/tcp"
      - "10000-10100:10000-10100/udp"
    volumes:
      - ./asterisk/asterisk-config:/etc/asterisk
      - ./asterisk/asterisk-logs:/var/log/asterisk
      - ./asterisk/asterisk-sounds:/var/lib/asterisk/sounds
    networks:
      - callcenter-net
    restart: unless-stopped

  sipp:
    image: ctaloi/sipp:latest
    container_name: sipp
    networks:
      - callcenter-net
    volumes:
      - ./sipp/scenarios:/scenarios
      - ./sipp/logs:/logs   
    depends_on:
      asterisk:
        condition: service_healthy
    entrypoint: ["/bin/sh", "-c"]
    command: ["tail", "-f", "/dev/null"]
    stdin_open: true
    tty: true
    
  test-container:
    image: alpine
    container_name: test-container
    networks:
      - callcenter-net
    command: sh -c "apk add --no-cache bash iproute2 iputils netcat-openbsd tcpdump curl procps && tail -f /dev/null"
    stdin_open: true
    tty: true

networks:
  callcenter-net:
    driver: bridge